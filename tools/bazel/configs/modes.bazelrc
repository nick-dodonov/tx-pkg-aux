# === РЕЖИМЫ СБОРКИ ===
# Различные режимы для development, release, debug и т.д.

# === SOURCE MODE ===
# Использование локальных исходников вместо registry
common:source --action_env=LWLOG_USE_SOURCE=1

# === DEBUG (отладка) ===
build:debug --spawn_strategy=local
build:debug --compilation_mode=dbg
build:debug --strip=never
build:debug --copt=-O0
build:debug --copt=-g3
build:debug --linkopt=-g

# === DEVELOPMENT (быстрая разработка) ===
build:dev --spawn_strategy=local
build:dev --compilation_mode=fastbuild
build:dev --strip=never
build:dev --copt=-O1

# === RELEASE (оптимизированная сборка) ===
build:release --compilation_mode=opt
build:release --strip=always
build:release --copt=-O3
build:release --copt=-DNDEBUG
#TODO: включить опцию линка для платформ, кроме EMSDK (иначе трактуется)
# build:release --linkopt=-s

# === HERMETIC (воспроизводимая сборка) ===
build:hermetic --action_env=-PATH
build:hermetic --host_action_env=-PATH
build:hermetic --action_env=-MAKE
build:hermetic --action_env=-CMAKE
build:hermetic --action_env=-PKG_CONFIG
build:hermetic --action_env=-NINJA
build:hermetic --sandbox_default_allow_network=false

# === TESTING ===
test:unit --test_output=errors
test:unit --test_summary=short
test:unit --test_timeout=60

test:integration --test_output=all
test:integration --test_summary=detailed
test:integration --test_timeout=300

test:performance --test_output=all
test:performance --test_timeout=600
test:performance --test_env=PERFORMANCE_TEST=1
