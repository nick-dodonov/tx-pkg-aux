# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—é Bazel

## üéØ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. `--config=profile` - –ü–æ–ª–Ω–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
bazel build --config=profile //...
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `--noslim_profile` - –æ—Ç–∫–ª—é—á–∞–µ—Ç —Å–∂–∞—Ç–∏–µ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
- `--experimental_profile_include_target_label` - –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ç–∫–∏ —Ü–µ–ª–µ–π
- `--experimental_profile_include_primary_output` - –≤–∫–ª—é—á–∞–µ—Ç –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
- `--record_full_profiler_data` - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `profile.json` (~3.7MB)
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ —Ü–µ–ª–µ–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### 2. `--config=profile-slim` - –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑, CI/CD, —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
bazel build --config=profile-slim //...
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- `--slim_profile` - –≤–∫–ª—é—á–∞–µ—Ç —Å–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `--experimental_profile_include_target_label` - –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ç–∫–∏ —Ü–µ–ª–µ–π
- –ë–µ–∑ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `profile-slim.json` (~249KB)
- –°–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

### ‚ùå –ë—ã–ª–∞ –ø—Ä–æ–±–ª–µ–º–∞:
```
WARNING: Enabling both --slim_profile and --experimental_profile_include_primary_output: 
the "out" field will be omitted in merged actions.
```

### ‚úÖ –†–µ—à–µ–Ω–∏–µ:
–†–∞–∑–¥–µ–ª–µ–Ω—ã –¥–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- **–ü–æ–ª–Ω–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: `--noslim_profile` + –≤—Å–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏
- **–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**: `--slim_profile` + –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–ª–∞–≥–∏

## üìà –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ https://ui.perfetto.dev/
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ profile.json –∏–ª–∏ profile-slim.json
```

### CLI –∞–Ω–∞–ª–∏–∑:
```bash
# –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑
bazel analyze-profile profile.json

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å
bazel analyze-profile --dump=action profile.json | grep "CRITICAL_PATH"

# –°–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
bazel analyze-profile --dump=action profile.json | head -20
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:
```bash
# –°–æ–∑–¥–∞—Ç—å HTML –æ—Ç—á–µ—Ç
bazel analyze-profile --html --html_details profile.json

# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
bazel analyze-profile --dump=action --format=csv profile.json > actions.csv
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
bazel build --config=profile //...          # –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
```

### –î–ª—è CI/CD:
```bash
bazel build --config=profile-slim //...     # –ë—ã—Å—Ç—Ä—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
```bash
# 1. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
bazel clean --expunge

# 2. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å—Ç–æ–π —Å–±–æ—Ä–∫–∏
bazel build --config=profile //...

# 3. –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—É—Ç–∏
bazel analyze-profile profile.json
```

## üìä –†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è | –í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞ |
|-------------|-------------|-------------|---------------|
| `profile` | ~3.7MB | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | –ú–µ–¥–ª–µ–Ω–Ω—ã–π |
| `profile-slim` | ~249KB | –û—Å–Ω–æ–≤–Ω–∞—è | –ë—ã—Å—Ç—Ä—ã–π |

## üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD

```yaml
# GitHub Actions –ø—Ä–∏–º–µ—Ä
- name: Build with profiling
  run: bazel build --config=profile-slim //...
  
- name: Upload profile
  uses: actions/upload-artifact@v3
  with:
    name: bazel-profile
    path: profile-slim.json
```

## üîç –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞–∫–µ—Ç–æ–≤** ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å MODULE.bazel
2. **–î–æ–ª–≥–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è** ‚Üí –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. **–ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ** ‚Üí –±–æ–ª—å—à–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
4. **Bootstrap –æ–ø–µ—Ä–∞—Ü–∏–∏** ‚Üí –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–í—Å–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –≤–∏–¥–Ω—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ! üìà