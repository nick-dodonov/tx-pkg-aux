# === ГЛАВНАЯ КОНФИГУРАЦИЯ BAZEL ===
# Модульная система конфигураций с импортами

# === MODULE REGISTRY ===
# Общие настройки для всех команд (build, query, mod, test, etc.)
common --registry=https://bcr.bazel.build/
common --registry=https://raw.githubusercontent.com/nick-dodonov/tx-kit-repo/main
#TODO: repo local setup: common --registry=file:///Users/rix/p/t/tx/tx-kit-repo

# === ИМПОРТ МОДУЛЬНЫХ КОНФИГУРАЦИЙ ===
try-import tools/bazel/configs/common.bazelrc
try-import tools/bazel/configs/platforms.bazelrc  
try-import tools/bazel/configs/targets.bazelrc
try-import tools/bazel/configs/modes.bazelrc

# === ПОЛЬЗОВАТЕЛЬСКИЕ НАСТРОЙКИ (не в git) ===
try-import .bazelrc.local

# === АВТООПРЕДЕЛЕНИЕ ПЛАТФОРМЫ ===
# Будет переопределено в .bazelrc.local автоматически
build:auto --config=macos --config=host --config=dev

# === ALIASES (удобные комбинации) ===
build:mac-dev --config=macos --config=host --config=dev
build:mac-release --config=macos --config=host --config=release
build:mac-debug --config=macos --config=host --config=debug

build:win-dev --config=windows --config=host --config=dev
build:win-release --config=windows --config=host --config=release

build:linux-dev --config=linux --config=host --config=dev
build:linux-ci --config=linux --config=host --config=release --config=ci

# === EMSCRIPTEN COMBINATIONS ===
build:wasm-dev --config=macos --config=wasm --config=dev
build:wasm-release --config=macos --config=wasm --config=release

# === TESTING COMBINATIONS ===
test:mac-unit --config=macos --config=host --config=dev --config=unit
test:mac-integration --config=macos --config=host --config=dev --config=integration

# === DEFAULT CONFIGURATION ===
# Базовые настройки применяются автоматически через .bazelrc.local
# Для явной настройки используйте: --config=mac-dev, --config=wasm-release и т.д.